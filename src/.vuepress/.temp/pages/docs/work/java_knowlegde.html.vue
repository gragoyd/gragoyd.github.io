<template><div><h3 id="记录一些杂的知识点" tabindex="-1"><a class="header-anchor" href="#记录一些杂的知识点" aria-hidden="true">#</a> 记录一些杂的知识点</h3>
<ul>
<li><a href="https://pdai.tech/md/java/thread/java-thread-x-juc-executor-ThreadPoolExecutor.html" target="_blank" rel="noopener noreferrer">线程池<ExternalLinkIcon/></a></li>
<li><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-02.html#_6-aqs" target="_blank" rel="noopener noreferrer">AQS(AbstractQueuedSyncronizer)<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/51075839" target="_blank" rel="noopener noreferrer">Redis 的 SDS<ExternalLinkIcon/></a>、<a href="https://blog.csdn.net/wr_java/article/details/115701942" target="_blank" rel="noopener noreferrer">Redis 的 zset 底层（跳表）<ExternalLinkIcon/></a>、<a href="https://zhuanlan.zhihu.com/p/102422311" target="_blank" rel="noopener noreferrer">Redis 的 list 底层<ExternalLinkIcon/></a></li>
<li><a href="https://www.cnblogs.com/ysocean/p/12422635.html" target="_blank" rel="noopener noreferrer">Redis 过期删除策略和内存淘汰策略<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/sunshine_lyn/article/details/82747596" target="_blank" rel="noopener noreferrer">B+ 树插入删除操作<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/tianjindong0804/article/details/86301179" target="_blank" rel="noopener noreferrer">二叉树插入节点后再平衡操作<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/mu_wind/article/details/110128016" target="_blank" rel="noopener noreferrer">数据库索引及其结构<ExternalLinkIcon/></a>、<a href="https://blog.csdn.net/lisu061714112/article/details/122398894" target="_blank" rel="noopener noreferrer">索引失效场景<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/qq_35634181/article/details/113280233" target="_blank" rel="noopener noreferrer">RC 与 RR 的 MVCC 实现<ExternalLinkIcon/></a>、<a href="https://www.cnblogs.com/wwcom123/p/10727194.html" target="_blank" rel="noopener noreferrer">当前读与快照读<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/huangjw_806/article/details/100927097" target="_blank" rel="noopener noreferrer">MySQL 中 RedoLog 与 BinLog 一致性问题<ExternalLinkIcon/></a>、<a href="https://www.cnblogs.com/caoweixiong/p/11824423.html" target="_blank" rel="noopener noreferrer">Canal 原理<ExternalLinkIcon/></a></li>
<li><a href="https://cloud.tencent.com/developer/article/1917325" target="_blank" rel="noopener noreferrer">MySQL 与 Redis 一致性问题<ExternalLinkIcon/></a></li>
<li><a href="https://www.cnblogs.com/qdhxhz/p/15587726.html" target="_blank" rel="noopener noreferrer">MySQL 的锁<ExternalLinkIcon/></a></li>
<li><a href="https://www.infoq.cn/article/DeDh79E4SrCrtwGBs47v" target="_blank" rel="noopener noreferrer">数据库迁移时如何确保数据一致性<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/chenshufeng115/article/details/110409845" target="_blank" rel="noopener noreferrer">基于 Lock+Condition 实现自定义阻塞队列<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/344459822" target="_blank" rel="noopener noreferrer">HashMap 为什么线程不安全<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/148837265" target="_blank" rel="noopener noreferrer">Redis 缓存穿透、缓存击穿、缓存雪崩<ExternalLinkIcon/></a>、(<a href="https://blog.csdn.net/a745233700/article/details/120814088" target="_blank" rel="noopener noreferrer">一致性哈希算法<ExternalLinkIcon/></a>、<a href="https://zhuanlan.zhihu.com/p/104124045" target="_blank" rel="noopener noreferrer">jump consistent hash<ExternalLinkIcon/></a>)</li>
<li><a href="https://blog.csdn.net/Me_xuan/article/details/124285425" target="_blank" rel="noopener noreferrer">Redis 持久化<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/94770324" target="_blank" rel="noopener noreferrer">抽象类与接口<ExternalLinkIcon/></a></li>
<li><a href="https://www.cnblogs.com/aspirant/p/11470858.html" target="_blank" rel="noopener noreferrer">synchronized 原理<ExternalLinkIcon/></a>、<a href="https://www.cnblogs.com/aspirant/p/8657681.html" target="_blank" rel="noopener noreferrer">Lock 原理<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/61221667" target="_blank" rel="noopener noreferrer">死锁的产生、防止、避免、检测和解除<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/377423211" target="_blank" rel="noopener noreferrer">synchronized 原理<ExternalLinkIcon/></a>、<a href="https://zhuanlan.zhihu.com/p/132714367" target="_blank" rel="noopener noreferrer">Java 常用锁的使用<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/58011817" target="_blank" rel="noopener noreferrer">MySQL 日志分类及简介<ExternalLinkIcon/></a>、<a href="https://www.cnblogs.com/bantiaoxianyu/p/16525837.html" target="_blank" rel="noopener noreferrer">MySQL 事务日志<ExternalLinkIcon/></a></li>
<li><a href="https://www.cnblogs.com/jackion5/p/13544927.html" target="_blank" rel="noopener noreferrer">操作系统 IO 模型<ExternalLinkIcon/></a>、<a href="https://www.cnblogs.com/cscshi/p/16525332.html" target="_blank" rel="noopener noreferrer">select &amp; poll &amp; epoll<ExternalLinkIcon/></a></li>
<li><a href="https://zhuanlan.zhihu.com/p/72616216" target="_blank" rel="noopener noreferrer">http &amp; https<ExternalLinkIcon/></a></li>
<li><a href="https://lijie.blog.csdn.net/article/details/105462088" target="_blank" rel="noopener noreferrer">BIO &amp; NIO &amp; AIO<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/qq_34650584/article/details/102658197" target="_blank" rel="noopener noreferrer">操作系统文件读写流程<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/qq_15371293/article/details/109921221" target="_blank" rel="noopener noreferrer">Java 实现线程安全的三种方式及如何保证线程安全<ExternalLinkIcon/></a></li>
<li><a href="https://www.cnblogs.com/vipstone/p/14239160.html" target="_blank" rel="noopener noreferrer">粘包及其解决方案<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/Xukaiy/article/details/118965347" target="_blank" rel="noopener noreferrer">TCP 的可靠性<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/u011066470/article/details/88089270" target="_blank" rel="noopener noreferrer">Kafka 消费流程<ExternalLinkIcon/></a></li>
<li><a href="https://blog.csdn.net/Remoa_Dengqinyi/article/details/75270453" target="_blank" rel="noopener noreferrer">策略模式、观察者模式<ExternalLinkIcon/></a></li>
</ul>
<h3 id="代码上线后-cpu-占用高排查过程" tabindex="-1"><a class="header-anchor" href="#代码上线后-cpu-占用高排查过程" aria-hidden="true">#</a> 代码上线后 CPU 占用高排查过程</h3>
<ol>
<li><code v-pre>top</code>查看占用 CPU 占用高的 PID（进程号）</li>
<li><code v-pre>top -Hp 进程号</code>查看该进程下所有线程的占用情况</li>
<li><code v-pre>printf &quot;%x\n&quot; 线程号</code>获取目标线程的十六进制表示</li>
<li><code v-pre>jstack 进程号 | grep -A 30 线程号的十六进制表示</code>输出该线程状态的前 30 行，定位到具体代码问题</li>
<li>可额外执行<code v-pre>jstat -gcutil 进程号 统计间隔毫秒数 统计次数（缺省则一直统计）</code>来查看进程 GC 的持续变化情况，若其中的<code v-pre>FGC</code>列很大且一直增大则确认 Full GC</li>
</ol>
<h3 id="单例模式" tabindex="-1"><a class="header-anchor" href="#单例模式" aria-hidden="true">#</a> 单例模式</h3>
<Tabs id="188" :data='[{"id":"饿汉式"},{"id":"双检锁懒汉式"},{"id":"静态内部类"},{"id":"ThreadLocal"}]'>
<template #title0="{ value, isActive }">饿汉式</template>
<template #title1="{ value, isActive }">双检锁懒汉式</template>
<template #title2="{ value, isActive }">静态内部类</template>
<template #title3="{ value, isActive }">ThreadLocal</template>
<template #tab0="{ value, isActive }">
<p>在类装载时就实例化以避免多线程问题，但也意味着需要一直占用内存</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">instance</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getInstance</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> instance;</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></template>
<template #tab1="{ value, isActive }">
<p>用于实例域的延迟初始化。两次检测解决多线程问题，不一定需要加锁</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">volatile</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">instance</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getInstance</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (instance == </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">synchronized</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">Singleton</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">class</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">                </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (instance == </span><span style="color: #569CD6">null</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">                    instance = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">            }</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> instance;</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></template>
<template #tab2="{ value, isActive }">
<p>用于静态域的延迟初始化。单例类装载时也不会初始化实例，在使用时才会装载内部类而实例化单例</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">SingletonHolder</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">INSTANCE</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getInstance</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">SingletonHolder</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">INSTANCE</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></template>
<template #tab3="{ value, isActive }">
<p>同步是以时间换空间，<code v-pre>ThreadLocal</code>是以空间换时间</p>
<div class="language-java line-numbers-mode" data-ext="java"><pre v-pre class="shiki dark-plus" style="background-color: #1E1E1E" tabindex="0"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">private</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">final</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ThreadLocal</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4">&gt; </span><span style="color: #9CDCFE">tl</span><span style="color: #D4D4D4"> = </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">ThreadLocal</span><span style="color: #D4D4D4">&lt;</span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4">&gt;() {</span></span>
<span class="line"><span style="color: #D4D4D4">        @</span><span style="color: #4EC9B0">Override</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">protected</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">initialValue</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">Singleton</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">        };</span></span>
<span class="line"><span style="color: #D4D4D4">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">public</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">static</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Singleton</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getInstance</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">tl</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">get</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></template>
</Tabs>
<!-- -------------------- -->
</div></template>


